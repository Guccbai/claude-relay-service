# Cloudflare Workers 配置文件
# 用于部署 Claude Relay Service OpenAI Responses API 代理

name = "claude-relay-openai-proxy"
main = "worker.js"
compatibility_date = "2024-01-01"

# 账户配置 (部署前需要填写)
# account_id = "your-account-id"

# 生产环境配置
[env.production]
name = "claude-relay-openai-proxy"
route = { pattern = "api.yourdomain.com/openai/*", zone_name = "yourdomain.com" }

# 上游服务配置 (使用环境变量)
[env.production.vars]
UPSTREAM_URL = "https://your-relay-service.example.com"
# 可选: 启用调试日志
DEBUG = "false"

# 开发环境配置
[env.development]
name = "claude-relay-openai-proxy-dev"

[env.development.vars]
UPSTREAM_URL = "http://localhost:3000"
DEBUG = "true"

# 预发布环境配置
[env.staging]
name = "claude-relay-openai-proxy-staging"
route = { pattern = "staging-api.yourdomain.com/openai/*", zone_name = "yourdomain.com" }

[env.staging.vars]
UPSTREAM_URL = "https://staging-relay.example.com"
DEBUG = "true"

# Workers 配置
[limits]
cpu_ms = 50000

# 日志和可观测性
[observability]
enabled = true

# 安全头配置
# 这些会在 worker.js 中处理

# 自定义域名配置示例 (可选)
# [[routes]]
# pattern = "openai-api.yourdomain.com/*"
# zone_name = "yourdomain.com"

# 使用 Cloudflare R2 存储日志 (可选)
# [[r2_buckets]]
# binding = "LOGS"
# bucket_name = "relay-logs"

# 使用 KV 存储缓存数据 (可选)
# [[kv_namespaces]]
# binding = "CACHE"
# id = "your-kv-namespace-id"

# 使用 Durable Objects (可选，用于限流)
# [[durable_objects.bindings]]
# name = "RATE_LIMITER"
# class_name = "RateLimiter"
